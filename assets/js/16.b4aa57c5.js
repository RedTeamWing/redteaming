(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{334:function(s,n,a){"use strict";a.r(n);var t=a(10),r=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"前言"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[s._v("#")]),s._v(" 前言")]),s._v(" "),n("p",[s._v("大致步骤就是:")]),s._v(" "),n("ul",[n("li",[s._v("app.js中提取所有js路径列表")]),s._v(" "),n("li",[s._v("获取 js内容")]),s._v(" "),n("li",[s._v("yakit脚本或者热加载功能一键提取api列表")]),s._v(" "),n("li",[s._v("fuzz api")]),s._v(" "),n("li",[s._v("fuzz api参数")]),s._v(" "),n("li",[s._v("getshell")])]),s._v(" "),n("h2",{attrs:{id:"详情"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#详情"}},[s._v("#")]),s._v(" 详情")]),s._v(" "),n("ol",[n("li",[s._v("根据js特征手动提取js路径列表(自动化待实现)")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.loli.net/2024/07/28/1OCW3b587XVSism.png",alt:""}})]),s._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[s._v("设置热加载代码")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.loli.net/2024/07/28/4XdWSc1yvkuITBM.png",alt:""}})]),s._v(" "),n("div",{staticClass:"language-yak line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('// 使用标签 {{yak(handle|param)}} 可触发热加载调用\nhandle = func(param) {\n    // 在这里可以直接返回一个字符串\n    return codec.EncodeBase64("base64-prefix" + param) + sprintf("_origin(%v)", param)\n}\n\n// 使用标签 {{yak(handle1|...)}} 可触发热加载调用\nhandle1 = func(param) {\n    // 这个特殊的 Hook 也支持返回数组\n    return ["12312312", "abc", "def"]\n}\n\n// beforeRequest 允许发送数据包前再做一次处理，定义为 func(origin []byte) []byte\nbeforeRequest = func(req) {\n    /*\n        // 我们可以提供一些基础用法，比如说单纯就是替换一个时间戳～\n        req = str.ReplaceAll(req, "TIMESTAMP_INT64", sprint(time.Now().Unix()))\n    */ \n    return []byte(req)\n}\n\n// afterRequest 允许对每一个请求的响应做处理，定义为 func(origin []byte) []byte\nafterRequest = func(rsp) {\n    return []byte(rsp)\n}\n\nvar linkCompilerStr2 = `(?:"|\')(((?:[a-zA-Z]{1,10}://|//)[^"\'/]{1,}\\.[a-zA-Z]{2,}[^"\']{0,})|((?:/|\\.\\./|\\./)[^"\'><,;|*()(%%$^/\\\\\\[\\]][^"\'><,;|()]{1,})|([a-zA-Z0-9_\\-/]{1,}/[a-zA-Z0-9_\\-/]{1,}\\.(?:[a-zA-Z]{1,4}|action)(?:[\\?|#][^"|\']{0,}|))|([a-zA-Z0-9_\\-/]{1,}/[a-zA-Z0-9_\\-/]{3,}(?:[\\?|#][^"|\']{0,}|))|([a-zA-Z0-9_\\-]{1,}\\.(?:\\w)(?:[\\?|#][^"|\']{0,}|)))(?:"|\')`\n\n// mirrorHTTPFlow 允许对每一个请求的响应做处理，定义为 func(req []byte, rsp []byte, params map[string]any) map[string]any\n// 返回值回作为下一个请求的参数，或者提取的数据，如果你需要解密响应内容，在这里操作是最合适的\nmirrorHTTPFlow = func(req, rsp, params) {\n    params["api_list"] = str.Join(re.FindAll(string(poc.GetHTTPPacketBody(rsp)),linkCompilerStr2),"\\n")\n    return params\n}\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[s._v("fuzz 提取api")])]),s._v(" "),n("p",[n("img",{attrs:{src:"https://s2.loli.net/2024/07/28/AbU2O7tCqeDi4N9.png",alt:""}})]),s._v(" "),n("p",[s._v("其实这个功能还有待优化，不如脚本来的方便")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('println(`Hello Yak World!`)\n\nfilename = "/Users/x/yakit-projects/temp/tmp937318693.txt"\ndata = file.ReadLines(filename)\n\nurl = "http://xxxx"\n\nvar linkCompilerStr = `(?:"|\')(((?:[a-zA-Z]{1,10}://|//)[^"\'/]{1,}\\.[a-zA-Z]{2,}[^"\']{0,})|((?:/|\\.\\./|\\./)[^"\'><,;|*()(%%$^/\\\\\\[\\]][^"\'><,;|()]{1,})|([a-zA-Z0-9_\\-/]{1,}/[a-zA-Z0-9_\\-/]{1,}\\.(?:[a-zA-Z]{1,4}|action)(?:[\\?|#][^"|\']{0,}|))|([a-zA-Z0-9_\\-/]{1,}/[a-zA-Z0-9_\\-/]{3,}(?:[\\?|#][^"|\']{0,}|))|([a-zA-Z0-9_\\-]{1,}\\.(?:\\w)(?:[\\?|#][^"|\']{0,}|)))(?:"|\')`\n\nvar apiList = []\nfor path in data {\n    target = url + path\n\n    println("正在请求:", target)\n    resp, req, err = poc.Get(target)\n    die(err)\n\n    res = re.FindAll(string(resp.GetBody()), linkCompilerStr)\n\n    for i in res {\n        apiList.Append(i)\n    }\n    \n}\n\n\napiList = str.RemoveRepeat(apiList)\nprint(len(apiList))\nf = file.OpenFile("/tmp/test.txt", file.O_CREATE | file.O_RDWR|file.O_APPEND, 0o777)~\ndefer f.Close()\n\n\nfor api in apiList {\n    if str.Contains(api, ".js") || str.Contains(api, ".png") || str.Contains(api, ".jpg") || str.Contains(api, ".gif") || str.Contains( api, "./") || str.Contains(api, ".vue")  {\n        continue\n    } else if str.StartsWith(api, "/" /*type: string*/) {\n        f.WriteLine(f`${api}`)\n    }\n    \n}\n\n\nprintln("done")\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br")])]),n("ol",{attrs:{start:"4"}},[n("li",[s._v("api fuzz")])]),s._v(" "),n("p",[s._v(".....\n.....\n.....")]),s._v(" "),n("ol",{attrs:{start:"5"}},[n("li",[s._v("param fuzz")])]),s._v(" "),n("p",[s._v(".....\n.....\n.....")])])}),[],!1,null,null,null);n.default=r.exports}}]);